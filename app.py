import streamlit as st
import random
import time
import os
from PIL import Image

# --- è¨­å®šé é¢ ---
st.set_page_config(
    page_title="åŒ—æ­ç›§æ©ç¬¦æ–‡æ•¸ä½è«®è©¢å¸«",
    page_icon="ğŸ”®",
    layout="wide"
)

# --- åœ–ç‰‡è·¯å¾‘è¨­å®š ---
# è«‹ç¢ºä¿æ‚¨çš„å°ˆæ¡ˆç›®éŒ„ä¸‹æœ‰ä¸€å€‹åç‚º images çš„è³‡æ–™å¤¾ï¼Œè£¡é¢æ”¾è‘—å°æ‡‰æª”åçš„åœ–ç‰‡
IMAGE_FOLDER = "images"

# --- 1. å®Œæ•´ç›§æ©ç¬¦æ–‡è³‡æ–™åº« (25å€‹ç¬¦æ–‡) ---
runes_db = {
    "Fehu": {
        "name": "Fehu (è²¡å¯Œ)",
        "dates": "06/29-07/13",
        "file_name": "Fehu",
        "meaning_up": "è±¡å¾µå®¶ç•œèˆ‡è²¡å¯Œã€‚è¾›è‹¦å¥®é¬¥è€Œå¾—åˆ°çš„çµæœï¼Œä¸éŒ¯çš„æŠ•è³‡æ©Ÿæœƒã€‚å–®ç´”å–„è‰¯ï¼Œäººè„ˆç¤¾äº¤èƒ½åŠ›å¥½ã€‚",
        "meaning_rev": "ä¸é©åˆæ–°è¨ˆç•«ï¼Œå¯èƒ½æœƒæœ‰ç„¡æ³•æŒ½æ•‘çš„è²¡ç”¢æå¤±ã€‚æƒ…æ„Ÿä¸Šå¯èƒ½æš«æ™‚å¤±å’Œï¼Œçˆ­åµçŒœå¿Œã€‚",
        "health": "ç²¾ç·»é£Ÿç‰©åƒå¤ªå¤šã€è‚¥èƒ–ã€‚",
        "career": "ç²¾å“ã€é‡‘èç”¢æ¥­ã€‚",
        "element": "ç«åœŸ"
    },
    "Uruz": {
        "name": "Uruz (æ¬ŠåŠ›/é‡ç‰›)",
        "dates": "07/14-07/28",
        "file_name": "Uruz",
        "meaning_up": "é‡ç‰›çš„è€åŠ›ã€‚æ”¹è®Šçš„åŠ›é‡ï¼Œå‹‡æ–¼è¿½æ±‚ç†æƒ³ï¼Œè¡Œå‹•åŠ›åè¶³ã€‚è‡ªç„¶ç™¼ç”Ÿçš„æ”¹è®Šã€‚",
        "meaning_rev": "è„†å¼±çš„æ„å¿—åŠ›ï¼Œç¼ºä¹è¡Œå‹•åŠ›ï¼ŒéŒ¯å¤±è‰¯æ©Ÿã€‚",
        "health": "ç”·æ€§æ€§åŠŸèƒ½ã€æ”è­·è…ºã€‚",
        "career": "ç¾é£Ÿé¤å»³ã€å¤§å‹é£²æ–™äº‹æ¥­ã€‚",
        "element": "åœŸ"
    },
    "Thurisaz": {
        "name": "Thurisaz (é›·ç¥ä¹‹æ§Œ)",
        "dates": "07/29-08/12",
        "file_name": "Thurisaz",
        "meaning_up": "å¥½é‹åŠä¿è­·ï¼Œå……æ»¿é­…åŠ›ä½†å®¹æ˜“å›ºåŸ·å·±è¦‹ã€‚èªªæœåŠ›ä½³ï¼Œå¥½ç«¶çˆ­ã€‚",
        "meaning_rev": "è‡ªæˆ‘åœ¨é˜»ç¤™å‰é€²ï¼Œå¥½é‹ç”¨å®Œï¼Œéœ€åœæ­¢å›ºåŸ·ã€‚è‹¥å†å›ºåŸ·å·±è¦‹å•é¡Œæœƒæ›´å¤§ã€‚",
        "health": "è‚è‡Ÿå•é¡Œã€å¤ªç´¯ã€çˆ†è‚ã€‚",
        "career": "é«˜ç§‘æŠ€æ¥­ã€éº»é†‰é†«å¸«ã€‚",
        "element": "ç«"
    },
    "Ansuz": {
        "name": "Ansuz (å¥§ä¸/æ™ºæ…§)",
        "dates": "08/13-08/28",
        "file_name": "Ansuz",
        "meaning_up": "æ™ºæ…§çŸ¥è­˜ï¼Œæºé€šè‰¯å¥½ï¼Œæœ‰é•·è€…é¢¨ç¯„ã€‚è‹¥æŠ•å…¥æ–°è¡Œæ¥­æœƒæœ‰é•·è€…å¼•é ˜ã€‚æ¸¬é©—èˆ‡å£ä¿¡ã€‚",
        "meaning_rev": "è¬Šè¨€ã€é¨™å±€ã€æºé€šå›°é›£ã€‚å­¸ç¿’çš„å›°å¢ƒæˆ–çŸ¥è­˜çš„èª¤ç”¨ã€‚",
        "health": "å–‰åš¨ã€å£è…”ã€‚",
        "career": "è€å¸«ã€å°ˆæ¥­é¡§å•ã€ç®¡ç†è·ã€‚",
        "element": "ç©ºæ°£"
    },
    "Raidho": {
        "name": "Raidho (ä½¿å¾’/é¦¬è»Š)",
        "dates": "08/29-09/12",
        "file_name": "Raidho",
        "meaning_up": "æ—…è¡Œã€ç§»å‹•ã€æ¢ç´¢å…§å¿ƒçš„çŸ¥æ€§ä¹‹æ—…ã€‚è¨è«–å”å•†å¥½æ™‚æ©Ÿã€‚è¡Œå‹•åŠ›åè¶³ã€‚",
        "meaning_rev": "å”å•†é€²å…¥æ­»èƒ¡åŒï¼Œç•™æ„äººéš›é—œä¿‚ã€‚ä¸å®‰å…¨çš„æ—…ç¨‹ï¼Œäº¤é€šå·¥å…·æ•…éšœã€‚",
        "health": "å¥”æ³¢æ“å‹ã€äº¤é€šæ„å¤–ã€‚",
        "career": "äº¤é€šé‹è¼¸ã€æ—…éŠè§€å…‰ã€èˆªç©ºã€‚",
        "element": "ç©ºæ°£"
    },
    "Kenaz": {
        "name": "Kenaz (çƒˆç«/ç«æŠŠ)",
        "dates": "09/13-09/27",
        "file_name": "Kenaz",
        "meaning_up": "é–‹å•Ÿå‰µé€ åŠ›ï¼Œå¥åº·æ´»åŠ›ã€‚æ–°æ¦‚å¿µåŠæƒ³æ³•çš„èª•ç”Ÿã€‚èƒ½é‡èˆ‡èƒ½åŠ›ã€‚",
        "meaning_rev": "çµæŸã€å¤±å»ã€å°ç”Ÿå‘½å¤±å»ç†±å¿±ã€‚éºå¤±ã€‚",
        "health": "ç”Ÿå‘½åŠ›è€—æï¼Œèˆ‡æ°£æœ‰é—œã€‚",
        "career": "è—è¡“ç›¸é—œã€ç²¾å“ã€‚",
        "element": "ç©ºæ°£"
    },
    "Gebo": {
        "name": "Gebo (å¥‰ç»/ç¦®ç‰©)",
        "dates": "09/28-10/12",
        "file_name": "Gebo",
        "meaning_up": "ç¦®ç‰©ï¼Œç¾å¥½çš„åˆå¤¥é—œä¿‚ï¼Œæ–½èˆ‡å—çš„å¹³è¡¡ã€‚å•é¡Œå³å°‡è§£è„«ã€‚æ‰¿è«¾ã€‚",
        "meaning_rev": "æ­¤ç‰Œé€šå¸¸è¦–ç‚ºç„¡é€†ä½ (æˆ–ä»£è¡¨å¤±è¡¡)ï¼Œæ•´é«”åå‘æ­£é¢ã€‚",
        "health": "è…¸èƒƒã€æ¶ˆåŒ–å¸æ”¶åŠŸèƒ½ã€‚",
        "career": "çµå©šç”¢æ¥­ã€è—è¡“ã€å…¬ç›Šã€èº«å¿ƒéˆã€‚",
        "element": "ç©º"
    },
    "Wunjo": {
        "name": "Wunjo (æ­¡æ„‰/å–œæ‚…)",
        "dates": "10/13-10/27",
        "file_name": "Wunjo",
        "meaning_up": "èµ°å‡ºè‡ªå·±çš„å–œæ‚…ï¼Œå¥½çš„çµæœã€‚è‹¥å•çµæœæ˜¯å¹¸é‹çš„ã€‚å¤©ç”Ÿæ¨‚è§€ã€‚",
        "meaning_rev": "æ­£åœ¨ç¶“æ­·å›°å¢ƒæˆ–å±æ©Ÿï¼Œä»¥åŠä¼´éš¨è€Œä¾†çš„ç—›è‹¦ã€‚ä¸æ˜¯ä¸‹é‡å¤§æ±ºå®šçš„æ™‚åˆ»ã€‚",
        "health": "å¿ƒè‡Ÿã€‚",
        "career": "å¨›æ¨‚äº‹æ¥­ã€è¡¨æ¼”è€…ã€å…«å¤§ç”¢æ¥­ã€‚",
        "element": "ç«"
    },
    "Hagalaz": {
        "name": "Hagalaz (é¢¶é¢¨/å†°é›¹)",
        "dates": "10/28-11/12",
        "file_name": "Hagalaz",
        "meaning_up": "ä¸å¯æ§åˆ¶çš„è®ŠåŒ–ï¼Œæ„å¤–ç™¼å±•ã€‚è‡ªç„¶å´©è§£çš„è±¡å¾µï¼Œé€²åŒ–è›»è®Šã€‚ä¸æ˜¯é–‹å§‹æ–°è¨ˆç•«çš„å¥½æ™‚æ©Ÿã€‚",
        "meaning_rev": "é€šå¸¸ç„¡é€†ä½ã€‚ä»£è¡¨å»¶é²ã€å¿…é ˆå¦¥å”ï¼Œå‹¿èˆ‡æƒ…å‹¢æŠ—çˆ­ã€‚",
        "health": "å¤©ç„¶ç½å®³ã€æ„å¤–ã€æ„Ÿå†’ã€ç—…æ¯’ã€‚",
        "career": "é¢¨éšªæ§åˆ¶ã€ä¿éšªæ¥­ã€å¾µä¿¡ç¤¾ã€‚",
        "element": "æ°´"
    },
    "Nauthiz": {
        "name": "Nauthiz (éœ€æ±‚/æŸç¸›)",
        "dates": "11/13-11/27",
        "file_name": "Nauthiz",
        "meaning_up": "ç—›è‹¦ç…ç†¬çš„éç¨‹ï¼Œé¢å°ç¾å¯¦å…§å¿ƒçš„æ¸´æœ›ã€‚ç”Ÿå­˜çš„åŸºæœ¬éœ€æ±‚ã€‚å»ºè­°ä¸‰æ€æ²‰æ¾±ã€‚",
        "meaning_rev": "ç›®å‰è¡Œå‹•æ˜¯ä¸æ°ç•¶çš„ï¼Œå¤±æ•—æ©Ÿæœƒå¤§ã€‚è¢«æƒ…æ„Ÿéœ€æ±‚æ§åˆ¶ã€‚",
        "health": "ç‡Ÿé¤Šå¸æ”¶ä¸è¶³ã€è…¸èƒƒç‹€æ³ã€‚",
        "career": "ç”Ÿæ´»ç”¨å“ã€æ°‘ç”Ÿæ¶ˆè²»å“ã€‚",
        "element": "ç«"
    },
    "Isa": {
        "name": "Isa (å†°é›ª/å‡çµ)",
        "dates": "11/28-12/12",
        "file_name": "Isa",
        "meaning_up": "å‡çµã€åœæ­¢ã€ç­‰å¾…ã€‚æš«åœæ‰€æœ‰æƒ³è¦é€²è¡Œçš„è¨ˆç•«ã€‚å†·éœã€‚",
        "meaning_rev": "é€šå¸¸ç„¡é€†ä½ã€‚åœ¨ç‰¹å®šè§£è®€å¯è¦–ç‚ºå†°é›ªèåŒ–ï¼Œå¾©ç”¦ä¸­ã€‚",
        "health": "æ‰‹è…³å†°å†·ã€æ°£å¡åœ¨å››è‚¢ä¸æµå‹•ã€‚",
        "career": "å°äº‹æ¥­å†·æ„Ÿï¼Œæ‡·ç–‘è‡ªæˆ‘èƒ½åŠ›ã€‚",
        "element": "æ°´"
    },
    "Jera": {
        "name": "Jera (è±æ”¶/æ”¶ç©«)",
        "dates": "12/13-12/27",
        "file_name": "Jera",
        "meaning_up": "è¾›è‹¦åŠªåŠ›çš„å›é¥‹ï¼Œé©ç•¶çš„æ™‚æ©Ÿæ‰æœƒæœ‰ç¾å¥½çš„çµæœã€‚è‡ªç„¶ç•Œçš„å› æœè¼ªè¿´ã€‚",
        "meaning_rev": "é€šå¸¸ç„¡é€†ä½ã€‚è‹¥æŒ‡è² é¢å‰‡ä»£è¡¨æ²’æœ‰åŠªåŠ›æŠ•å…¥ï¼Œçµæœä¸å¦‚é æœŸã€‚",
        "health": "æ¶ˆåŒ–å¸æ”¶æœ‰é—œã€‚",
        "career": "é‡‘èç”¢æ¥­ã€ç™½æ‰‹èµ·å®¶ã€‚",
        "element": "åœŸ"
    },
    "Eihwaz": {
        "name": "Eihwaz (ç´«æ‰/ä¸–ç•Œæ¨¹)",
        "dates": "12/28-01/12",
        "file_name": "Eihwaz",
        "meaning_up": "æœ‰åŸå‰‡åœ°ç‚ºç›®æ¨™æ…¢æ…¢å‰é€²ï¼Œè¶ŠæŒ«è¶Šå‹‡ã€‚ä¿è­·å±¬æ€§ã€‚é€£çµäººé¡èˆ‡ç²¾éˆã€‚",
        "meaning_rev": "èº«å¿ƒæ­£åœ¨è½‰åŒ–ä¸­ï¼Œæ‰“ç ´ä¾·é™ï¼Œæƒ³è„«é›¢éå»æ¨¡å¼ã€‚",
        "health": "è„Šæ¤ã€‚",
        "career": "å…¬å‹™äººå“¡ã€è¨˜å¸³å£«ã€ä½œæ¥­å“¡ã€‚",
        "element": "åœŸé¢¨ç«æ°´"
    },
    "Perthro": {
        "name": "Perthro (è–æ¯/ç§˜å¯†)",
        "dates": "01/13-01/27",
        "file_name": "Perthro",
        "meaning_up": "æœªçŸ¥çš„é©šå–œæ­£åœ¨æ­ç¤ºä¸­ï¼Œç›´è¦ºåŠ›å¼·ã€‚ç”Ÿå‘½çš„å¯èƒ½æ€§æ­£åœ¨è½‰è®Šã€‚æŠ•æ©Ÿè²¡ä½³ã€‚",
        "meaning_rev": "ä¸é©åˆæŠ•è³‡ã€åˆå¤¥ã€‚æ€§ç”Ÿæ´»å•é¡Œã€‚ä¸é©åˆå€ŸéŒ¢ã€‚",
        "health": "å©¦ç§‘ã€æ€§å™¨å®˜ã€‚",
        "career": "å¥³æ€§ç”¢æ¥­ã€åšå¼ˆã€æ•´å½¢è¡Œæ¥­ã€‚",
        "element": "æ°´"
    },
    "Algiz": {
        "name": "Algiz (ä¿è­·/éº‹é¹¿)",
        "dates": "01/28-02/12",
        "file_name": "Algiz",
        "meaning_up": "ç©©å®šç´°å¿ƒç­‰å¾…ï¼Œå®ˆè­·æ€§å¼·ã€‚äº‹æ¥­ç©©å®šæˆé•·ã€‚åˆ†æè¦åŠƒæ€§å¼·ã€‚",
        "meaning_rev": "å®¹æ˜“å—åˆ°å‚·å®³ï¼Œè¢«åˆ©ç”¨ï¼Œä¸é©åˆç™¼å±•ã€‚åŠªåŠ›çš„ä¸€åˆ‡æœƒæˆç‚ºçŠ§ç‰²ã€‚",
        "health": "è…°æ¤ã€‚",
        "career": "ä¿å…¨ã€è»äººã€ä¸­éšä¸»ç®¡ã€‚",
        "element": "é¢¨"
    },
    "Sowilo": {
        "name": "Sowilo (å¤ªé™½/å‹åˆ©)",
        "dates": "02/13-02/26",
        "file_name": "Sowilo",
        "meaning_up": "æˆåŠŸã€å‹åˆ©ã€æ­£å‘ç©æ¥µã€‚å‹‡æ•¢è¿½æ±‚æ‰€æ„›ã€‚è‡ªæˆ‘å¯¦ç¾ã€‚",
        "meaning_rev": "é€šå¸¸ç„¡é€†ä½ã€‚è‹¥æœ‰å‰‡æŒ‡æ†‚æ…®ç·Šå¼µï¼Œæˆ–çŸ­æš«çš„å½±éŸ¿ã€‚",
        "health": "é ­éƒ¨ã€‚",
        "career": "èƒ½æºã€æ¼”è—äººå“¡ã€ä¸»ç®¡ã€‚",
        "element": "é¢¨"
    },
    "Tiwaz": {
        "name": "Tiwaz (æˆ°ç¥/æ­£ç¾©)",
        "dates": "02/27-03/13",
        "file_name": "Tiwaz",
        "meaning_up": "æ­£ç¾©å…¬ç†ï¼Œå‹‡å¾€ç›´å‰ã€‚æœ‰è²¬ä»»åŠç†æƒ³ã€‚æ„åœ–ç´”æ­£ã€‚",
        "meaning_rev": "ç¼ºä¹å‹•åŠ›ï¼Œé‡åˆ°ç“¶é ¸ã€‚æ„Ÿæƒ…ä¸Šå‹•æ©Ÿä¸å–®ç´”ï¼Œç„¡æ³•é•·ä¹…ã€‚",
        "health": "è‚è‡Ÿæ©Ÿèƒ½ã€‚",
        "career": "é«˜éšä¸»ç®¡ã€è»æ”¿ã€æ³•å¾‹ã€è­¦å¯Ÿã€‚",
        "element": "ç©ºæ°£"
    },
    "Berkano": {
        "name": "Berkano (ç”Ÿè‚²/æ¨ºæ¨¹)",
        "dates": "03/14-03/30",
        "file_name": "Berkano",
        "meaning_up": "æ–°çš„é–‹å§‹ï¼Œæˆé•·é‡ç”Ÿã€‚é‚Šå­¸ç¿’é‚Šæˆé•·ã€‚æ¯æ€§ç‰¹è³ªã€‚",
        "meaning_rev": "åœæ»¯å€¦æ€ ã€‚å®¶äººæˆ–è¦ªå¯†çš„äººçš„æ“”æ†‚(è­¦å‘Š)ã€‚",
        "health": "å©¦ç§‘ã€åµå·¢ã€‚",
        "career": "æ•™è‚²ã€ç…§é¡§ã€åœ’è—ã€‚",
        "element": "é¢¨"
    },
    "Ehwaz": {
        "name": "Ehwaz (ç¥é§’/é¦¬)",
        "dates": "03/31-04/13",
        "file_name": "Ehwaz",
        "meaning_up": "ç§»å‹•ã€æ¬å®¶ã€é€æ­¥ç™¼å±•ç©©å®šé€²æ­¥ã€‚å¿ èª çš„åˆä½œå¤¥ä¼´ã€‚è²·è³£äº¤æ˜“ã€‚",
        "meaning_rev": "åœæ»¯ï¼Œç‹€æ…‹ä¸å¦‚é æœŸã€‚å¾€å‰è¡æ™‚ï¼Œè¦åœä¸‹ä¾†è§€æœ›ã€‚",
        "health": "é—œç¯€ã€è…³ã€äº¤é€šæ„å¤–ã€‚",
        "career": "è²¿æ˜“ã€è²·è³£ã€æ—…éŠã€‚",
        "element": "åœŸ" 
    },
    "Mannaz": {
        "name": "Mannaz (äººé¡/è‡ªæˆ‘)",
        "dates": "04/14-04/28",
        "file_name": "Mannaz",
        "meaning_up": "äººéš›é€£çµï¼Œè‡ªæˆ‘æ‡·ç–‘ (éœ€æ·±å…¥äº†è§£äººå¿ƒ)ã€‚å£æ‰å¤©ä»½ã€‚",
        "meaning_rev": "æœ‰è¢«å®³å—å‚·çš„æ„Ÿè¦ºï¼Œå­¤ç«‹ã€‚è‹¥æœ‰æ•µäººæ˜¯è‡ªå·±ã€‚",
        "health": "ç²¾ç¥ç‹€æ³ã€å¿ƒç†å¥åº·ã€‚",
        "career": "å…¬é—œã€æ¥­å‹™ã€å¿ƒç†è«®å•†ã€‚",
        "element": "ç©ºæ°£"
    },
    "Laguz": {
        "name": "Laguz (æ°´/ç›´è¦º)",
        "dates": "04/29-05/13",
        "file_name": "Laguz",
        "meaning_up": "é †æš¢å¹³éœï¼Œæ´»åœ¨ç›´è¦ºè£¡ã€‚å‰µæ„é»å­å¤šã€‚å…§æ–‚æ·±è—ä¸éœ²ã€‚",
        "meaning_rev": "æ²‰æººåœ¨æ†‚å‚·ä¸­ï¼Œæƒ…æ„Ÿåœæ»¯ã€‚ä¸é©åˆç­‰å¾…ï¼Œéœ€ç©æ¥µè¡Œå‹•ã€‚",
        "health": "è…è‡Ÿã€‚",
        "career": "è—è¡“ã€ç¾å®¹ã€é£²æ–™æ¥­ã€SPAã€‚",
        "element": "æ°´"
    },
    "Ingwaz": {
        "name": "Ingwaz (å¤©ä½¿/è±é¥’)",
        "dates": "05/14-05/28",
        "file_name": "Ingwaz",
        "meaning_up": "åœ“æ»¿çš„çµå±€ï¼Œåšäº‹åš´è¬¹ã€‚å°ˆæ¥­é ˜åŸŸæœ‰å¥½è¡¨ç¾ã€‚é ˜è¢–ç‰¹è³ªã€‚",
        "meaning_rev": "é€šå¸¸ç„¡é€†ä½ã€‚ä»£è¡¨å…§åœ¨è–æ½”æœ¬è³ªèˆ‡é ˜å°åŠ›ã€‚",
        "health": "å…ç–«ç³»çµ±ã€‚",
        "career": "é¤Šç”Ÿé£Ÿå“ã€å­¸è¡“ç ”ç©¶ã€é‹å‹•å™¨æã€‚",
        "element": "å¤§åœ°/æ°´"
    },
    "Othala": {
        "name": "Othala (å®¶åº­/ç¹¼æ‰¿)",
        "dates": "05/29-06/13",
        "file_name": "Othala",
        "meaning_up": "æ“æœ‰ã€å®¶åº­å‚³æ‰¿ã€èªåŒåŠå®‰å…¨æ„Ÿã€‚é‡è¦–å‹™å¯¦èˆ‡äº«æ¨‚ã€‚åœŸåœ°æˆ–æˆ¿å­ã€‚",
        "meaning_rev": "æ²’æœ‰ç²å¾—èªåŒæ„Ÿï¼Œç¼ºä¹é‡‘éŒ¢æ´åŠ©ã€‚ä¸ç†Ÿæ‚‰çš„é ˜åŸŸã€‚",
        "health": "å®¶æ—éºå‚³ç–¾ç—…ã€‚",
        "career": "æˆ¿åœ°ç”¢ã€å®¶æ¥­ã€å»ºç¯‰ã€‚",
        "element": "å¤§åœ°"
    },
    "Dagaz": {
        "name": "Dagaz (é»æ˜/çªç ´)",
        "dates": "06/14-06/28",
        "file_name": "Dagaz",
        "meaning_up": "æ–°çš„ç”Ÿæ´»æ–¹å¼ï¼Œå¢åŠ å’Œæˆé•·ã€‚é»æ˜å‰çš„é»‘æš—å·²éã€‚å¤©çœŸç´”æ½”ã€‚",
        "meaning_rev": "é€šå¸¸ç„¡é€†ä½ã€‚ä»£è¡¨ç­‰å¾…çš„è€æ€§èˆ‡çœŸèª ç†±æƒ…ã€‚",
        "health": "çœ¼ç›ã€‚",
        "career": "å¾æ”¿ã€ç²¾å“ã€å¹•åƒšã€‚",
        "element": "é¢¨ç«"
    },
    "Wyrd": {
        "name": "Wyrd (ç©ºç‰Œ/å‘½é‹)",
        "dates": "ç„¡",
        "file_name": "Wyrd",
        "meaning_up": "å› æœæ¥­åŠ›ï¼Œè½å¾ç¥çš„å®‰æ’ã€‚æœªçŸ¥çš„è®Šæ•¸ã€‚ä¸€åˆ‡çš„çŸ¥è­˜ã€‚",
        "meaning_rev": "åŒæ­£ä½ã€‚è‹¥å‡ºç¾åœ¨çµæœä½ç½®ï¼Œä»£è¡¨å•é¡Œæ­¤åˆ»ç„¡ç­”æ¡ˆã€‚",
        "health": "éœ€åƒè€ƒä¼´éš¨çš„ç¬¦æ–‡ã€‚",
        "career": "å‘½é‹çš„è½‰æŠ˜é»ã€‚",
        "element": "è™›ç©º"
    }
}

rune_keys = list(runes_db.keys())

# --- å´é‚Šæ¬„ ---
st.sidebar.title("ğŸŒ¿ ç›§æ©æŒ‡å¼•å°èˆª")
menu = st.sidebar.radio(
    "è«‹é¸æ“‡æœå‹™ï¼š",
    ["ğŸ™ éœå¿ƒå„€å¼ (é¦–é )", "âœ¨ å–®å¼µï¼šæ¯æ—¥/ç°¡æ˜“æŒ‡å¼•", "âš–ï¸ ä¸‰å¼µï¼šèº«å¿ƒ/æ™‚é–“æµ", "ğŸŒŸ äº”å¼µï¼šå…¨æ–¹ä½è§£æ", "ğŸ“š ç›§æ©ç¬¦æ–‡åœ–æ›¸é¤¨"]
)

# --- è¼”åŠ©å‡½å¼ï¼šæŠ½ç‰Œèˆ‡åœ–ç‰‡è™•ç† ---
def get_rune_image(file_base_name, is_reversed):
    """
    è®€å–åœ–ç‰‡ï¼Œå¦‚æœæŠ½åˆ°é€†ä½å‰‡æ—‹è½‰ 180 åº¦ã€‚
    æœƒå˜—è©¦è®€å– .png, .jpg, .jpeg
    """
    possible_extensions = [".png", ".jpg", ".jpeg"]
    image_path = None
    
    # å°‹æ‰¾æª”æ¡ˆ
    for ext in possible_extensions:
        temp_path = os.path.join(IMAGE_FOLDER, file_base_name + ext)
        if os.path.exists(temp_path):
            image_path = temp_path
            break
            
    if image_path:
        try:
            img = Image.open(image_path)
            # å¦‚æœæ˜¯é€†ä½ï¼Œé€²è¡Œæ—‹è½‰
            if is_reversed:
                img = img.rotate(180)
            return img
        except Exception as e:
            st.error(f"è®€å–åœ–ç‰‡éŒ¯èª¤: {e}")
            return None
    else:
        return None

def draw_runes(count):
    """å¾25å€‹ç¬¦æ–‡ä¸­æŠ½å‡ºæŒ‡å®šæ•¸é‡ï¼Œä¸¦éš¨æ©Ÿæ±ºå®šæ­£é€†ä½"""
    drawn_keys = random.sample(rune_keys, count)
    results = []
    for key in drawn_keys:
        is_reversed = random.choice([True, False])
        results.append({"key": key, "reversed": is_reversed})
    return results

def display_rune_card(rune_data, position_name):
    """é¡¯ç¤ºå–®å¼µå¡ç‰‡è³‡è¨Š (å«åœ–ç‰‡)"""
    rune_info = runes_db[rune_data['key']]
    
    # åˆ¤æ–·æ˜¯å¦ç‚ºå°ç¨±ç¬¦æ–‡ (è¬›ç¾©ä¸­æœ‰äº›ç¬¦æ–‡ç„¡é€†ä½æ„ç¾©)
    symmetrical_runes = ["Gebo", "Isa", "Ingwaz", "Dagaz", "Sowilo", "Hagalaz", "Jera", "Eihwaz", "Wyrd"]
    is_symmetrical = rune_data['key'] in symmetrical_runes
    
    if is_symmetrical:
        status = "æ­£ä½ (æ­¤ç‰Œç„¡é€†ä½)"
        meaning = rune_info['meaning_up']
        # å°ç¨±ç‰Œå³ä¾¿æŠ½åˆ° reversed=Trueï¼Œé¡¯ç¤ºæ­£ä½åœ–ç‰‡
        img = get_rune_image(rune_info['file_name'], False) 
    else:
        status = "é€†ä½ (Reversed)" if rune_data['reversed'] else "æ­£ä½ (Upright)"
        meaning = rune_info['meaning_rev'] if rune_data['reversed'] else rune_info['meaning_up']
        img = get_rune_image(rune_info['file_name'], rune_data['reversed'])

    # CSS æ¨£å¼
    card_style = """
    <div style="
        border: 2px solid #d4af37; 
        border-radius: 15px; 
        padding: 20px; 
        margin-bottom: 20px; 
        background-color: #ffffff;
        box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);
        text-align: center;
        color: #333333;
    ">
    """
    
    st.markdown(card_style, unsafe_allow_html=True)
    st.markdown(f"<h4 style='color:#555;'>{position_name}</h4>", unsafe_allow_html=True)
    
    if img:
        st.image(img, width=150, caption=status)
    else:
        # å¦‚æœæ‰¾ä¸åˆ°åœ–ç‰‡ï¼Œé¡¯ç¤ºæ–‡å­—æ›¿ä»£
        st.markdown(f"<h1>ğŸª¨</h1>", unsafe_allow_html=True)
        st.caption(f"(åœ–ç‰‡æœªæ‰¾åˆ°: {rune_info['file_name']})")

    st.markdown(f"<h3>{rune_info['name']}</h3>", unsafe_allow_html=True)
    st.markdown(f"<hr style='margin: 10px 0; border-top: 1px solid #eee;'>", unsafe_allow_html=True)
    st.markdown(f"<p style='text-align: left;'><b>ğŸ“œ å«ç¾©ï¼š</b>{meaning}</p>", unsafe_allow_html=True)
    
    # æ‘ºç–Šè©³ç´°è³‡è¨Š
    with st.expander("æŸ¥çœ‹æ›´å¤šè©³æƒ… (å¥åº·/äº‹æ¥­)"):
        st.markdown(f"**ğŸ“… æ—¥æœŸ**ï¼š{rune_info['dates']} | **ğŸª å…ƒç´ **ï¼š{rune_info['element']}")
        st.markdown(f"**ğŸ’¼ äº‹æ¥­**ï¼š{rune_info['career']}")
        st.markdown(f"**ğŸ¥ å¥åº·**ï¼š{rune_info['health']}")
        
    st.markdown("</div>", unsafe_allow_html=True)

# --- é é¢å…§å®¹é‚è¼¯ ---

if menu == "ğŸ™ éœå¿ƒå„€å¼ (é¦–é )":
    st.title("æ­¡è¿ä¾†åˆ°ç›§æ©æ™ºæ…§è–æ®¿ ğŸŒ²")
    st.markdown("""
    ### è«‹æ•™ç¥ä¹‹æ—¨æ„
    ç›§æ©ç¬¦æ–‡ä¸¦ä¸æ˜¯å–®ç´”çš„ç®—å‘½ï¼Œè€Œæ˜¯**åœ¨ä½ è‡ªå·±èº«ä¸Šæ‰¾åˆ°ç­”æ¡ˆ**ã€‚ç¥æ—¨æœƒæ ¹æ“šç•¶ä¸‹çš„æ™‚ç©ºèƒŒæ™¯ï¼Œå¾è®Šæ•¸ä¸­æŒ‡å¼•ä½ ï¼Œè®“ä½ é‡å°çœ¼å‰å•é¡Œåšæœ€å¾Œçš„æ±ºå®šã€‚
    
    ---
    ### ğŸ§˜ å„€å¼å‰æº–å‚™
    1. **èº«é«”æ”¾é¬†**ï¼šæ‰¾å€‹èˆ’é©çš„ä½ç½®åä¸‹ã€‚
    2. **å¿ƒéˆæ·¨ç©º**ï¼šé–‰ä¸Šçœ¼ç›ï¼Œæ·±å‘¼å¸ä¸‰æ¬¡ï¼Œè®“æ€ç·’éœä¸‹ä¾†ã€‚
    
    ### ğŸ“œ å¥§ä¸ç¦±è©
    è«‹åœ¨å¿ƒä¸­é»˜å¿µä»¥ä¸‹ç¦±è©ï¼Œé€£çµå¤è€çš„æ™ºæ…§ï¼š
    > **ã€Œå…¨èƒ½ä¸”æœ‰æ™ºæ…§çš„å¥§ä¸ç¥ï¼Œç›§æ©çš„ä¸»äººï¼Œ** > **è«‹æŒ‡å¼•æˆ‘çš„æ‰‹åŠæ„å¿µï¼Œ** > **è®“æˆ‘å¾—åˆ°çœŸç†ã€‚ã€**
    
    ---
    æº–å‚™å¥½å¾Œï¼Œè«‹å¾å·¦å´é¸å–®é¸æ“‡é©åˆä½ çš„ç‰Œé™£ã€‚
    """)

elif menu == "âœ¨ å–®å¼µï¼šæ¯æ—¥/ç°¡æ˜“æŒ‡å¼•":
    st.header("âœ¨ å–®å¼µç›§æ©ï¼šè¿…é€ŸæŒ‡å¼•")
    st.markdown("""
    **é©ç”¨æƒ…å¢ƒï¼š**
    * **æ¯æ—¥é‹å‹¢**ï¼šã€Œæˆ‘ä»Šå¤©æœƒå¦‚ä½•ï¼Ÿã€
    * **æœªçŸ¥ç‹€æ³**ï¼šã€Œåœ¨æˆ‘ç›®å‰çš„ç”Ÿå‘½ä¸­ï¼Œæœ€éœ€è¦çš„æ˜¯ä»€éº¼ï¼Ÿã€
    * **ç‰¹å®šå°è±¡**ï¼šã€ŒæŸäººç›®å‰ç‹€æ³å¦‚ä½•ï¼Ÿã€
    """)
    
    if st.button("ğŸ”® èª å¿ƒæŠ½ç‰Œ"):
        with st.spinner("é€£çµå¥§ä¸çš„æ™ºæ…§ä¸­..."):
            time.sleep(1.5)
            result = draw_runes(1)[0]
            display_rune_card(result, "æŒ‡å¼•ç›§æ©")
            
            st.info("ğŸ’¡ **è§£è®€æç¤º**ï¼šè‹¥æ˜¯è©¢å•ã€Œæ˜¯ä¸æ˜¯ã€çš„å•é¡Œï¼Œæ­£ä½é€šå¸¸ä»£è¡¨è‚¯å®š/é©åˆï¼Œé€†ä½ä»£è¡¨ä¸é©åˆæˆ–éœ€æ”¹å–„ã€‚")

elif menu == "âš–ï¸ ä¸‰å¼µï¼šèº«å¿ƒ/æ™‚é–“æµ":
    st.header("âš–ï¸ ä¸‰å¼µç‰Œé™£ï¼šæ·±åº¦æ´å¯Ÿ")
    spread_type = st.selectbox("ç‰Œé™£æ¨¡å¼", ["æ™‚é–“æµ (éå»/ç¾åœ¨/æœªä¾†)", "è¡Œå‹•æŒ‡å¼• (å•é¡Œ/ä½œæ³•/çµæœ)", "æ˜¯/å¦ æ±ºç­–æ“´å±•"])
    
    labels = []
    if spread_type == "æ™‚é–“æµ (éå»/ç¾åœ¨/æœªä¾†)":
        labels = ["1. éå» (Past)", "2. ç¾åœ¨ (Present)", "3. æœªä¾† (Future)"]
    elif spread_type == "è¡Œå‹•æŒ‡å¼• (å•é¡Œ/ä½œæ³•/çµæœ)":
        labels = ["1. å•é¡Œ (The Issue)", "2. ä½œæ³• (Action)", "3. çµæœ (Result)"]
        st.caption("è¬›ç¾©æç¤ºï¼šé‡å°å›°å¢ƒæ¡å–ä½œæ³•(2)ï¼Œå¦‚æœéµå¾ªï¼Œçµæœ(3)æœƒå¦‚ä½•ï¼Ÿ")
    else:
        labels = ["1. åŸºç¤/ç¾æ³", "2. æŒ‘æˆ°/è®Šæ•¸", "3. å»ºè­°/çµæœ"]
        st.caption("è¬›ç¾©æç¤ºï¼š2/3 æ­£ä½ä»£è¡¨é©åˆï¼Œé€†ä½ä»£è¡¨ä¸é©åˆã€‚")

    if st.button("ğŸ”® èª å¿ƒæŠ½ç‰Œ"):
        with st.spinner("è§£è®€å‘½é‹ä¹‹ç¶²..."):
            time.sleep(2)
            results = draw_runes(3)
            
            col1, col2, col3 = st.columns(3)
            with col1:
                display_rune_card(results[0], labels[0])
            with col2:
                display_rune_card(results[1], labels[1])
            with col3:
                display_rune_card(results[2], labels[2])
            
            st.warning("âš ï¸ æ³¨æ„ï¼šå¦‚æœçµæœä½ç½®(ç¬¬3å¼µ)å‡ºç¾**ç©ºç‰Œ(Wyrd)**ï¼Œè¡¨ç¤ºå•é¡Œä¸æ˜¯åœ¨æ­¤æ™‚å¾—åˆ°ç­”æ¡ˆï¼Œéœ€è½å¾ç¥çš„å®‰æ’ã€‚")

elif menu == "ğŸŒŸ äº”å¼µï¼šå…¨æ–¹ä½è§£æ":
    st.header("ğŸŒŸ äº”å¼µç‰Œé™£ï¼šå…¨æ¯è§€é»")
    st.markdown("é©ç”¨æ–¼è¤‡é›œå•é¡Œçš„æ·±åº¦è§£æï¼Œæä¾›è©³ç›¡çš„ç´°ç¯€èˆ‡èªªæ˜ã€‚")
    
    if st.button("ğŸ”® èª å¿ƒæŠ½ç‰Œ"):
        with st.spinner("å±•é–‹ç¥è–ç¥­å£‡..."):
            time.sleep(2.5)
            results = draw_runes(5)
            
            c1, c2, c3 = st.columns(3)
            with c1:
                display_rune_card(results[0], "1. éå» (å› ç´ )")
            with c2:
                display_rune_card(results[1], "2. ç¾åœ¨ (ç‹€æ³)")
            with c3:
                display_rune_card(results[2], "3. æœªä¾† (ç™¼å±•)")
            
            st.markdown("---")
            
            c4, c5 = st.columns(2)
            with c4:
                display_rune_card(results[3], "4. å¹«åŠ©/å»ºè­°")
            with c5:
                display_rune_card(results[4], "5. å•é¡Œ/æŒ‘æˆ°")
            
            st.success("ğŸ’¡ **å°ˆå®¶æç¤º**ï¼š\n* è‹¥ã€Œå•é¡Œ/æŒ‘æˆ°ã€(5)å‡ºç¾æ­£é¢ç›§æ©ï¼šè¡¨ç¤ºæ²’æœ‰å¤ªå¤§å›°é›£ã€‚\n* è‹¥ã€Œå•é¡Œ/æŒ‘æˆ°ã€(5)å‡ºç¾ç©ºç‰Œï¼šç„¡è¨ˆå¯æ–½ï¼Œä»»ç”±å‘½é‹å®‰æ’ã€‚")

elif menu == "ğŸ“š ç›§æ©ç¬¦æ–‡åœ–æ›¸é¤¨":
    st.header("ğŸ“š ç›§æ©ç¬¦æ–‡åœ–æ›¸é¤¨")
    search_rune = st.selectbox("é¸æ“‡ç¬¦æ–‡æŸ¥çœ‹è©³æƒ…ï¼š", rune_keys)
    
    if search_rune:
        info = runes_db[search_rune]
        img = get_rune_image(info['file_name'], False) # åœ–æ›¸é¤¨ä¸€å¾‹é¡¯ç¤ºæ­£ä½
        
        col_img, col_txt = st.columns([1, 2])
        with col_img:
            if img:
                st.image(img, caption=info['name'])
            else:
                st.write("(åœ–ç‰‡æœªæ‰¾åˆ°)")
        
        with col_txt:
            st.subheader(f"{info['name']}")
            st.write(f"**æ—¥æœŸ**ï¼š{info['dates']}")
            st.markdown(f"**ğŸŸ¢ æ­£ä½æ„ç¾©**ï¼š{info['meaning_up']}")
            st.markdown(f"**ğŸ”´ é€†ä½æ„ç¾©**ï¼š{info['meaning_rev']}")
            st.markdown(f"**ğŸ’¼ äº‹æ¥­é‹**ï¼š{info['career']}")
            st.markdown(f"**ğŸ¥ å¥åº·é‹**ï¼š{info['health']}")

st.divider()
st.markdown("<center>ç”±åŒ—æ­ç›§æ©ç¬¦æ–‡æ•¸ä½è«®è©¢å¸«åœ˜éšŠé–‹ç™¼ | è³‡æ–™ä¾†æºï¼šåŒ—æ­ç›§æ©ç¬¦æ–‡è«®è©¢å¸«æ•´åˆç­è¬›ç¾© & åˆéšè­‰æ›¸èª²ç¨‹è¬›ç¾©</center>", unsafe_allow_html=True)
